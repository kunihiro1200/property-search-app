---
inclusion: manual
---

# 大分市の住所ベースエリアマッピング定義

## ⚠️ 重要：大分市内の特定地域は複数エリアに該当する

大分市内の一部の地域は、市全域エリア（㊵）に加えて、**特定のエリア番号**にも該当します。

---

## 📋 大分市の住所ベースマッピング

### ①エリア（大道町周辺）

**住所パターン**:
- 大道町、要町、新町、末広町、太平町、田室町
- 大道西、大道東、大道
- 王子北町、王子新町、王子中町、王子西町、王子町、王子港町、王子南町、王子山の手町
- 新春日町、勢家町、中春日町、西春日町、東春日町、南春日町、南王子町
- 上春日町、季の坂、椎迫、志手
- にじが丘、ほたるの杜団地
- 府内町
- 中央町、金池町、荷揚町、城崎町
- 高崎

**該当エリア**:
- ✅ **①** ← 大道町周辺エリア
- ✅ **㊵** ← 大分市全域

**例**:
- `大分市大道町1-1-1` → `①, ㊵`
- `大分市王子町2-2-2` → `①, ㊵`
- `大分市新春日町3-3-3` → `①, ㊵`
- `大分市府内町4-4-4` → `①, ㊵`
- `大分市中央町1-1-1` → `①, ㊵`
- `大分市金池町2-2-2` → `①, ㊵`
- `大分市荷揚町3-3-3` → `①, ㊵`
- `大分市城崎町4-4-4` → `①, ㊵`
- `大分市高崎1-1-1` → `①, ㊵`

---

### ②エリア

**住所パターン**:
- 萩原
- 新貝、新栄町、高城新町、高城本町、高城西町、高城南町
- 高松1丁目、高松2丁目、高松東1丁目、高松東2丁目、高松東3丁目
- 花高松1丁目、花高松2丁目、花高松3丁目
- 原川1丁目、原川2丁目、原川3丁目、原新町
- 日岡1丁目、日岡2丁目、日岡3丁目、日吉町
- 松原町1丁目、松原町2丁目、松原町3丁目
- 向原沖1丁目、向原沖2丁目、向原沖3丁目
- 向原西1丁目、向原西2丁目
- 向原東1丁目、向原東2丁目
- 岡、岡新町、乙津港町、千歳、千歳団地、寺崎町、仲西町
- 三川上、三川下、三川新町、桃園団地
- 山津、山津町1丁目、山津町2丁目、小池原

**該当エリア**:
- ✅ **②** ← ②エリア
- ✅ **㊵** ← 大分市全域

**例**:
- `大分市萩原３丁目20-34` → `②, ㊵`
- `大分市新貝1-2-3` → `②, ㊵`
- `大分市高松1丁目4-5-6` → `②, ㊵`
- `大分市向原沖1丁目7-8-9` → `②, ㊵`

---

### ③エリア

**住所パターン**:
- 久保山団地、新明治、横尾東町、パークヒルズ久保山
- 大字猪野、猪野南、大字葛木、葛木、大字森、大字横尾
- 法勝台、小池原、公園通り、京が丘
- 大字大津留、毛井、松岡
- 下郡、明野高尾

**該当エリア**:
- ✅ **③** ← ③エリア
- ✅ **㊵** ← 大分市全域

**例**:
- `大分市久保山団地1-1-1` → `③, ㊵`
- `大分市横尾東町2-2-2` → `③, ㊵`
- `大分市大字猪野3-3-3` → `③, ㊵`
- `大分市法勝台4-4-4` → `③, ㊵`
- `大分市下郡1-1-1` → `③, ㊵`
- `大分市明野高尾2-2-2` → `③, ㊵`

---

### ④エリア

**住所パターン**:
- 鶴崎コスモス団地、森、金谷、大字下徳丸、下徳丸、関園、常行、南関、門迫、堂園
- 大字常行、大字鶴瀬、大字丸亀、亀甲、上徳丸、大字南つるさき、陽光台
- 宮河内ハイランド、リバーサイド、若葉台
- 大字迫、大字種具、種具、大字広内、大字宮河内、杵河内、迫、阿蘇、入新田、浄土寺、宮谷
- 別保

**該当エリア**:
- ✅ **④** ← ④エリア
- ✅ **㊵** ← 大分市全域

**例**:
- `大分市鶴崎コスモス団地1-1-1` → `④, ㊵`
- `大分市金谷2-2-2` → `④, ㊵`
- `大分市宮河内ハイランド3-3-3` → `④, ㊵`
- `大分市大字迫4-4-4` → `④, ㊵`
- `大分市別保1-1-1` → `④, ㊵`

---

### ⑥エリア

**住所パターン**:
- 賀来北、賀来西、賀来南、国分新町、国分台、国分団地、東野台
- 大字賀来、大字国分、大字東院、大字中尾
- カームタウン、野田、中尾、森ノ木、脇、大字野田、宮苑
- 大字平横瀬、大字宮苑、餅田

**該当エリア**:
- ✅ **⑥** ← ⑥エリア
- ✅ **㊵** ← 大分市全域

**例**:
- `大分市賀来北1-1-1` → `⑥, ㊵`
- `大分市国分新町2-2-2` → `⑥, ㊵`
- `大分市大字賀来3-3-3` → `⑥, ㊵`
- `大分市野田4-4-4` → `⑥, ㊵`

---

### ⑦エリア

**住所パターン**:
- ふじが丘、富士見が丘、田尻、光吉
- 大字今市、石合、一本櫟、今市町、上石合、白家、摺練ケ迫、山中
- 大字入蔵、吉熊、日方、羽原
- 大字太田、太田、田ノ口、原村
- 大字上詰、湛水
- 大字沢田、沢田
- 大字下原
- 大字高原
- 大字竹矢
- 大字辻原
- 大字荷尾杵
- 大字野津原
- 大字福宗
- 大字廻栖野
- 敷戸、古国府

**該当エリア**:
- ✅ **⑦** ← ⑦エリア
- ✅ **㊵** ← 大分市全域

**例**:
- `大分市ふじが丘1-1-1` → `⑦, ㊵`
- `大分市富士見が丘2-2-2` → `⑦, ㊵`
- `大分市田尻3-3-3` → `⑦, ㊵`
- `大分市光吉4-4-4` → `⑦, ㊵`
- `大分市大字今市5-5-5` → `⑦, ㊵`
- `大分市吉熊6-6-6` → `⑦, ㊵`
- `大分市大字野津原7-7-7` → `⑦, ㊵`
- `大分市敷戸1-1-1` → `⑦, ㊵`
- `大分市古国府2-2-2` → `⑦, ㊵`

---

### ⑧エリア

**住所パターン**:
- 戸次、中判田
- 大字安藤、大字河原内、大字竹中、大字端登
- 鴛野

**該当エリア**:
- ✅ **⑧** ← ⑧エリア
- ✅ **㊵** ← 大分市全域

**例**:
- `大分市戸次1-1-1` → `⑧, ㊵`
- `大分市中判田2-2-2` → `⑧, ㊵`
- `大分市大字安藤3-3-3` → `⑧, ㊵`
- `大分市大字河原内4-4-4` → `⑧, ㊵`
- `大分市鴛野1-1-1` → `⑧, ㊵`

---

## 🔧 実装方法

### 1. OitaCityAreaMappingServiceの作成（✅ 実装済み）

別府市の`BeppuAreaMappingService`と同じアプローチで、大分市の住所ベースマッピングサービスを作成しました。

**ファイル**: `backend/src/services/OitaCityAreaMappingService.ts`

**メソッド**:
```typescript
async getDistributionAreasForAddress(address: string): Promise<string | null>
```

**実装済みマッピングロジック**:
```typescript
// ①エリア（大道町周辺）
const area1Patterns = [
  '大道町', '要町', '新町', '末広町', '太平町', '田室町',
  '大道西', '大道東', '大道',
  '王子北町', '王子新町', '王子中町', '王子西町', '王子町', '王子港町', '王子南町', '王子山の手町',
  '新春日町', '勢家町', '中春日町', '西春日町', '東春日町', '南春日町', '南王子町',
  '上春日町', '季の坂', '椎迫', '志手',
  'にじが丘', 'ほたるの杜団地'
];
if (area1Patterns.some(pattern => address.includes(pattern))) {
  return '①';
}

// ②エリア
const area2Patterns = [
  '萩原',
  '新貝', '新栄町', '高城新町', '高城本町', '高城西町', '高城南町',
  '高松1丁目', '高松2丁目', '高松東1丁目', '高松東2丁目', '高松東3丁目',
  '花高松1丁目', '花高松2丁目', '花高松3丁目',
  '原川1丁目', '原川2丁目', '原川3丁目', '原新町',
  '日岡1丁目', '日岡2丁目', '日岡3丁目', '日吉町',
  '松原町1丁目', '松原町2丁目', '松原町3丁目',
  '向原沖1丁目', '向原沖2丁目', '向原沖3丁目',
  '向原西1丁目', '向原西2丁目',
  '向原東1丁目', '向原東2丁目',
  '岡', '岡新町', '乙津港町', '千歳', '千歳団地', '寺崎町', '仲西町',
  '三川上', '三川下', '三川新町', '桃園団地',
  '山津', '山津町1丁目', '山津町2丁目', '小池原'
];
if (area2Patterns.some(pattern => address.includes(pattern))) {
  return '②';
}

// ③エリア
const area3Patterns = [
  '久保山団地', '新明治', '横尾東町', 'パークヒルズ久保山',
  '大字猪野', '猪野南', '大字葛木', '葛木', '大字森', '大字横尾',
  '法勝台', '小池原', '公園通り', '京が丘',
  '大字大津留', '毛井', '松岡'
];
if (area3Patterns.some(pattern => address.includes(pattern))) {
  return '③';
}

// ④エリア
const area4Patterns = [
  '鶴崎コスモス団地', '森', '金谷', '大字下徳丸', '下徳丸', '関園', '常行', '南関', '門迫', '堂園',
  '大字常行', '大字鶴瀬', '大字丸亀', '亀甲', '上徳丸', '大字南つるさき', '陽光台',
  '宮河内ハイランド', 'リバーサイド', '若葉台',
  '大字迫', '大字種具', '種具', '大字広内', '大字宮河内', '杵河内', '迫', '阿蘇', '入新田', '浄土寺', '宮谷'
];
if (area4Patterns.some(pattern => address.includes(pattern))) {
  return '④';
}

// ⑥エリア
const area6Patterns = [
  '賀来北', '賀来西', '賀来南', '国分新町', '国分台', '国分団地', '東野台',
  '大字賀来', '大字国分', '大字東院', '大字中尾',
  'カームタウン', '野田', '中尾', '森ノ木', '脇', '大字野田', '宮苑',
  '大字平横瀬', '大字宮苑', '餅田'
];
if (area6Patterns.some(pattern => address.includes(pattern))) {
  return '⑥';
}

// ⑦エリア
const area7Patterns = ['ふじが丘', '富士見が丘', '田尻', '光吉'];
if (area7Patterns.some(pattern => address.includes(pattern))) {
  return '⑦';
}

// ⑧エリア
const area8Patterns = ['戸次', '中判田'];
if (area8Patterns.some(pattern => address.includes(pattern))) {
  return '⑧';
}

return null; // マッピングなし
```

---

### 2. PropertyDistributionAreaCalculatorの修正（✅ 実装済み）

`calculateDistributionAreas`メソッドで、大分市の場合も住所ベースマッピングを適用しています。

**修正箇所**: `backend/src/services/PropertyDistributionAreaCalculator.ts`

**実装済み内容**:
```typescript
if (normalizedCity.includes('大分')) {
  // 大分市全域エリアを追加
  cityWideAreas.push('㊵');
  
  // 住所ベースの詳細エリアを取得
  if (address) {
    const oitaAreas = await this.oitaCityAreaMappingService.getDistributionAreasForAddress(address);
    
    if (oitaAreas) {
      console.log(`[DistributionArea] Oita detailed areas: ${oitaAreas}`);
      const detailedAreas = this.parseAreaNumbers(oitaAreas);
      cityWideAreas.push(...detailedAreas);
    }
  }
}
```

---

## 📝 今後の拡張

大分市内の他の地域で、特定のエリア番号に該当する地域がある場合は、`OitaCityAreaMappingService`に追加してください。

**追加方法**:
```typescript
// 新しい地域を追加
const newAreaPatterns = ['地域名1', '地域名2', '地域名3'];
if (newAreaPatterns.some(pattern => address.includes(pattern))) {
  console.log(`[OitaCityAreaMapping] 新エリア detected → ③`);
  return '③';
}
```

---

## ✅ 実装完了

**実装済みエリア**:
- ✅ ①エリア（大道町周辺）: 36地域（中央町、金池町、荷揚町、城崎町を追加）
- ✅ ②エリア: 48地域（萩原、新貝、高城、高松、花高松、原川、日岡、松原町、向原、岡、千歳、三川、桃園団地、山津、小池原等）
- ✅ ③エリア: 19地域（久保山団地、横尾、猪野、葛木、森、法勝台、公園通り、京が丘、大津留、毛井、松岡、下郡、明野高尾等）
- ✅ ④エリア: 32地域（鶴崎コスモス団地、森、金谷、下徳丸、関園、常行、南関、門迫、堂園、鶴瀬、丸亀、亀甲、上徳丸、南つるさき、陽光台、宮河内ハイランド、リバーサイド、若葉台、迫、種具、広内、宮河内、杵河内、阿蘇、入新田、浄土寺、宮谷、別保等）
- ✅ ⑥エリア: 21地域（賀来北、賀来西、賀来南、国分新町、国分台、国分団地、東野台、大字賀来、大字国分、大字東院、大字中尾、カームタウン、野田、中尾、森ノ木、脇、大字野田、宮苑、大字平横瀬、大字宮苑、餅田等）
- ✅ ⑦エリア: 35地域（ふじが丘、富士見が丘、田尻、光吉、大字今市、石合、一本櫟、今市町、上石合、白家、摺練ケ迫、山中、大字入蔵、吉熊、日方、羽原、大字太田、太田、田ノ口、原村、大字上詰、湛水、大字沢田、沢田、大字下原、大字高原、大字竹矢、大字辻原、大字荷尾杵、大字野津原、大字福宗、大字廻栖野、敷戸、古国府等）
- ✅ ⑧エリア: 7地域（戸次、中判田、大字安藤、大字河原内、大字竹中、大字端登、鴛野）

**動作確認**:
- ✅ AA13530（萩原）が`②, ㊵`を返すことを確認済み
- ✅ `PropertyDistributionAreaCalculator`に統合済み
- ✅ 近隣買主リストで正しくフィルタリングされることを確認済み

---

## ✅ テスト

### テストケース1: 萩原（②エリア）

**入力**:
- 住所: `大分市萩原３丁目20-34`
- Google Map URL: なし

**期待される出力**:
- エリア: `②, ㊵`

### テストケース2: 大道町（①エリア）

**入力**:
- 住所: `大分市大道町1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `①, ㊵`

### テストケース3: ふじが丘（⑦エリア）

**入力**:
- 住所: `大分市ふじが丘1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `⑦, ㊵`

### テストケース4: 大字今市（⑦エリア）

**入力**:
- 住所: `大分市大字今市1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `⑦, ㊵`

### テストケース5: 吉熊（⑦エリア）

**入力**:
- 住所: `大分市吉熊1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `⑦, ㊵`

### テストケース6: 戸次（⑧エリア）

**入力**:
- 住所: `大分市戸次1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `⑧, ㊵`

### テストケース7: 大字安藤（⑧エリア）

**入力**:
- 住所: `大分市大字安藤1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `⑧, ㊵`

### テストケース8: 鶴崎コスモス団地（④エリア）

**入力**:
- 住所: `大分市鶴崎コスモス団地1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `④, ㊵`

### テストケース9: 賀来北（⑥エリア）

**入力**:
- 住所: `大分市賀来北1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `⑥, ㊵`

### テストケース10: 府内町（①エリア）

**入力**:
- 住所: `大分市府内町1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `①, ㊵`

### テストケース11: 鴛野（⑧エリア）

**入力**:
- 住所: `大分市鴛野1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `⑧, ㊵`

### テストケース12: 中央町（①エリア）

**入力**:
- 住所: `大分市中央町1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `①, ㊵`

### テストケース13: 金池町（①エリア）

**入力**:
- 住所: `大分市金池町2-2-2`
- Google Map URL: なし

**期待される出力**:
- エリア: `①, ㊵`

### テストケース14: 荷揚町（①エリア）

**入力**:
- 住所: `大分市荷揚町3-3-3`
- Google Map URL: なし

**期待される出力**:
- エリア: `①, ㊵`

### テストケース15: 城崎町（①エリア）

**入力**:
- 住所: `大分市城崎町4-4-4`
- Google Map URL: なし

**期待される出力**:
- エリア: `①, ㊵`

### テストケース16: 下郡（③エリア）

**入力**:
- 住所: `大分市下郡1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `③, ㊵`

### テストケース17: 明野高尾（③エリア）

**入力**:
- 住所: `大分市明野高尾1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `③, ㊵`

### テストケース18: 別保（④エリア）

**入力**:
- 住所: `大分市別保1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `④, ㊵`

### テストケース18: 敷戸（⑦エリア）

**入力**:
- 住所: `大分市敷戸1-1-1`
- Google Map URL: なし

**期待される出力**:
- エリア: `⑦, ㊵`

### テストケース19: 古国府（⑦エリア）

**入力**:
- 住所: `大分市古国府2-2-2`
- Google Map URL: なし

**期待される出力**:
- エリア: `⑦, ㊵`

## まとめ

**大分市の住所ベースマッピング**:
- ①エリア（大道町周辺） → `①, ㊵`
- ②エリア（萩原） → `②, ㊵`
- ③エリア（久保山団地、横尾、猪野等） → `③, ㊵`
- ④エリア（鶴崎コスモス団地、金谷、宮河内ハイランド等） → `④, ㊵`
- ⑥エリア（賀来北、国分新町、野田等） → `⑥, ㊵`
- ⑦エリア（ふじが丘、富士見が丘、田尻、光吉） → `⑦, ㊵`
- ⑧エリア（戸次、中判田） → `⑧, ㊵`
- その他の大分市 → `㊵`のみ

**このルールを徹底することで、大分市内の特定地域が正しく複数のエリアに配信されます。**

---

**最終更新日**: 2026年2月5日  
**作成理由**: 大分市内の住所ベースエリアマッピングを完全に定義化するため  
**更新履歴**:
- 2026年2月5日: 高崎を①エリアに追加、合計199地域
- 2026年2月5日: 明野高尾を③エリアに追加、合計198地域
- 2026年2月5日: 追加地域を実装（①エリア: 中央町、金池町、荷揚町、城崎町 / ③エリア: 下郡 / ④エリア: 別保 / ⑦エリア: 敷戸、古国府 / ⑧エリア: 鴛野）、合計197地域
- 2026年2月5日: ⑦エリア（29地域追加、合計33地域）、⑧エリア（4地域追加、合計6地域）、①エリア（府内町追加、合計32地域）を追加、全エリア実装完了
- 2026年2月5日: ④エリア（31地域）と⑥エリア（21地域）を追加、全エリア実装完了
- 2026年2月5日: ②エリアに47地域追加、③エリアに17地域追加、実装完了
- 2026年2月5日: ①⑦⑧エリアのマッピングを追加、実装完了

