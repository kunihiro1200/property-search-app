---
inclusion: manual
---

# å…¬é–‹ç‰©ä»¶ã‚µã‚¤ãƒˆã®è¡¨ç¤ºãƒ«ãƒ¼ãƒ«ï¼ˆçµ¶å¯¾ã«é–“é•ãˆãªã„ãƒ«ãƒ¼ãƒ«ï¼‰

## âš ï¸ æœ€é‡è¦ï¼šå…¬é–‹ç‰©ä»¶ã‚µã‚¤ãƒˆã¯å…¨ã¦ã®ç‰©ä»¶ã‚’è¡¨ç¤ºã™ã‚‹

**å…¬é–‹ç‰©ä»¶ã‚µã‚¤ãƒˆã¯`atbb_status`ã«é–¢ä¿‚ãªãã€å…¨ã¦ã®ç‰©ä»¶ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚**

---

## âœ… è¡¨ç¤ºãƒ«ãƒ¼ãƒ«

### 1. **å…¨ã¦ã®ç‰©ä»¶ãŒè¡¨ç¤ºã•ã‚Œã‚‹**

- âœ… `atbb_status`ãŒã€Œå…¬é–‹ä¸­ã€ã®ç‰©ä»¶ â†’ è¡¨ç¤ºã•ã‚Œã‚‹
- âœ… `atbb_status`ãŒã€Œå…¬é–‹å‰ã€ã®ç‰©ä»¶ â†’ è¡¨ç¤ºã•ã‚Œã‚‹
- âœ… `atbb_status`ãŒã€Œéå…¬é–‹ï¼ˆé…ä¿¡ãƒ¡ãƒ¼ãƒ«ã®ã¿ï¼‰ã€ã®ç‰©ä»¶ â†’ è¡¨ç¤ºã•ã‚Œã‚‹
- âœ… `atbb_status`ãŒã€Œéå…¬é–‹ï¼ˆå°‚ä»»ï¼‰ã€ã®ç‰©ä»¶ â†’ è¡¨ç¤ºã•ã‚Œã‚‹
- âœ… `atbb_status`ãŒã€Œæˆç´„æ¸ˆã¿ã€ã®ç‰©ä»¶ â†’ è¡¨ç¤ºã•ã‚Œã‚‹
- âœ… `atbb_status`ãŒ`null`ã®ç‰©ä»¶ â†’ è¡¨ç¤ºã•ã‚Œã‚‹
- âœ… **å…¨ã¦ã®ç‰©ä»¶ãŒè¡¨ç¤ºã•ã‚Œã‚‹**

### 2. **ãƒãƒƒã‚¸ã§çŠ¶æ…‹ã‚’è¡¨ç¤º**

ç‰©ä»¶ã®çŠ¶æ…‹ã¯**ãƒãƒƒã‚¸**ã§è¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

| atbb_status | ãƒãƒƒã‚¸ | èª¬æ˜ |
|------------|--------|------|
| ã€Œå…¬é–‹ä¸­ã€ã‚’å«ã‚€ | ãªã— | é€šå¸¸ã®å…¬é–‹ç‰©ä»¶ |
| ã€Œå…¬é–‹å‰ã€ã‚’å«ã‚€ | ã€Œå…¬é–‹å‰ã€ï¼ˆã‚ªãƒ¬ãƒ³ã‚¸ï¼‰ | å…¬é–‹å‰ã®ç‰©ä»¶ |
| ã€Œéå…¬é–‹ï¼ˆé…ä¿¡ãƒ¡ãƒ¼ãƒ«ã®ã¿ï¼‰ã€ã‚’å«ã‚€ | ã€Œé…ä¿¡é™å®šã€ï¼ˆé’ï¼‰ | é…ä¿¡é™å®šç‰©ä»¶ |
| **ã€Œéå…¬é–‹ã€ã‚’å«ã‚€ï¼ˆé…ä¿¡ãƒ¡ãƒ¼ãƒ«ã®ã¿ä»¥å¤–ï¼‰** | **ã€Œæˆç´„æ¸ˆã¿ã€ï¼ˆã‚°ãƒ¬ãƒ¼ï¼‰** | **éå…¬é–‹ç‰©ä»¶** |
| **ãã®ä»–** | **ã€Œæˆç´„æ¸ˆã¿ã€ï¼ˆã‚°ãƒ¬ãƒ¼ï¼‰** | **éå…¬é–‹ç‰©ä»¶** |

---

## âŒ é–“é•ã£ãŸç†è§£ï¼ˆçµ¶å¯¾ã«ã‚„ã‚‰ãªã„ï¼‰

### âŒ é–“é•ã„1: ã€Œå…¬é–‹ä¸­ã®ç‰©ä»¶ã ã‘ã‚’è¡¨ç¤ºã™ã‚‹ã€

```typescript
// âŒ çµ¶å¯¾ã«ã‚„ã‚‰ãªã„ï¼ˆå…¨ã¦ã®ç‰©ä»¶ã‚’è¡¨ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼‰
query = query.or(
  'atbb_status.ilike.%å…¬é–‹ä¸­%,' +
  'atbb_status.ilike.%å…¬é–‹å‰%,' +
  'atbb_status.ilike.%éå…¬é–‹ï¼ˆé…ä¿¡ãƒ¡ãƒ¼ãƒ«ã®ã¿ï¼‰%'
);
```

### âŒ é–“é•ã„2: ã€Œéå…¬é–‹ã®ç‰©ä»¶ã‚’é™¤å¤–ã™ã‚‹ã€

```typescript
// âŒ çµ¶å¯¾ã«ã‚„ã‚‰ãªã„ï¼ˆéå…¬é–‹ã®ç‰©ä»¶ã‚‚è¡¨ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼‰
query = query.not('atbb_status', 'ilike', '%éå…¬é–‹%');
```

---

## âœ… æ­£ã—ã„å®Ÿè£…

### 1. **å…¨ã¦ã®ç‰©ä»¶ã‚’å–å¾—ã™ã‚‹**

```typescript
async getAllProperties() {
  // âœ… atbb_statusã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãªã„ï¼ˆå…¨ã¦ã®ç‰©ä»¶ã‚’å–å¾—ï¼‰
  let query = this.supabase
    .from('property_listings')
    .select('*');
  
  // ã‚½ãƒ¼ãƒˆé †ã®ã¿æŒ‡å®š
  query = query
    .order('distribution_date', { ascending: false, nullsFirst: false })
    .order('created_at', { ascending: false });
  
  const { data, error } = await query;
  return data;
}
```

### 2. **ãƒãƒƒã‚¸è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯**

```typescript
function getPropertyBadge(atbbStatus: string | null): string | null {
  if (!atbbStatus) return 'completed'; // æˆç´„æ¸ˆã¿
  
  if (atbbStatus.includes('å…¬é–‹å‰')) return 'pre_release'; // å…¬é–‹å‰
  if (atbbStatus.includes('éå…¬é–‹ï¼ˆé…ä¿¡ãƒ¡ãƒ¼ãƒ«ã®ã¿ï¼‰')) return 'email_only'; // é…ä¿¡é™å®š
  if (atbbStatus.includes('å…¬é–‹ä¸­')) return null; // ãƒãƒƒã‚¸ãªã—
  
  // ãã®ä»–ï¼ˆéå…¬é–‹ã€æˆç´„æ¸ˆã¿ãªã©ï¼‰
  return 'completed'; // æˆç´„æ¸ˆã¿
}
```

---

## ğŸ” ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

å…¬é–‹ç‰©ä»¶ã‚µã‚¤ãƒˆã«é–¢ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã«ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

- [ ] **å…¨ã¦ã®ç‰©ä»¶ã‚’å–å¾—ã—ã¦ã„ã‚‹ã‹ï¼Ÿ**ï¼ˆatbb_statusã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¦ã„ãªã„ã‹ï¼Ÿï¼‰
- [ ] ãƒãƒƒã‚¸è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ã¯æ­£ã—ã„ã‹ï¼Ÿ
- [ ] éå…¬é–‹ã®ç‰©ä»¶ã‚‚è¡¨ç¤ºã•ã‚Œã‚‹ã‹ï¼Ÿ
- [ ] ã‚½ãƒ¼ãƒˆé †ã¯`distribution_date DESC, created_at DESC`ã‹ï¼Ÿ

---

## ğŸš¨ çµ¶å¯¾ã«å®ˆã‚‹ã¹ããƒ«ãƒ¼ãƒ«

### ãƒ«ãƒ¼ãƒ«1: atbb_statusã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãªã„

```typescript
// âŒ çµ¶å¯¾ã«ã‚„ã‚‰ãªã„ï¼ˆå…¨ã¦ã®ç‰©ä»¶ã‚’è¡¨ç¤ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼‰
query = query.or(
  'atbb_status.ilike.%å…¬é–‹ä¸­%,' +
  'atbb_status.ilike.%å…¬é–‹å‰%,' +
  'atbb_status.ilike.%éå…¬é–‹ï¼ˆé…ä¿¡ãƒ¡ãƒ¼ãƒ«ã®ã¿ï¼‰%'
);

// âœ… æ­£ã—ã„ï¼ˆatbb_statusã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãªã„ï¼‰
query = this.supabase
  .from('property_listings')
  .select('*')
  .order('distribution_date', { ascending: false, nullsFirst: false })
  .order('created_at', { ascending: false });
```

### ãƒ«ãƒ¼ãƒ«2: éå…¬é–‹ã®ç‰©ä»¶ã‚‚è¡¨ç¤ºã™ã‚‹

```typescript
// âŒ çµ¶å¯¾ã«ã‚„ã‚‰ãªã„
query = query.not('atbb_status', 'ilike', '%éå…¬é–‹%');

// âœ… æ­£ã—ã„ï¼ˆå…¨ã¦ã®ç‰©ä»¶ã‚’è¡¨ç¤ºï¼‰
// ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãªã„
```

### ãƒ«ãƒ¼ãƒ«3: ãƒãƒƒã‚¸ã§çŠ¶æ…‹ã‚’è¡¨ç¤ºã™ã‚‹

```typescript
// âœ… æ­£ã—ã„ï¼ˆãƒãƒƒã‚¸ã§çŠ¶æ…‹ã‚’è¡¨ç¤ºï¼‰
function getPropertyBadge(atbbStatus: string | null): string | null {
  if (!atbbStatus) return 'completed';
  if (atbbStatus.includes('å…¬é–‹å‰')) return 'pre_release';
  if (atbbStatus.includes('éå…¬é–‹ï¼ˆé…ä¿¡ãƒ¡ãƒ¼ãƒ«ã®ã¿ï¼‰')) return 'email_only';
  if (atbbStatus.includes('å…¬é–‹ä¸­')) return null;
  return 'completed'; // ãã®ä»–ï¼ˆéå…¬é–‹ã€æˆç´„æ¸ˆã¿ãªã©ï¼‰
}
```

---

## ğŸ“ ã¾ã¨ã‚

**å…¬é–‹ç‰©ä»¶ã‚µã‚¤ãƒˆã®è¡¨ç¤ºãƒ«ãƒ¼ãƒ«**:

1. âœ… **å…¨ã¦ã®ç‰©ä»¶ã‚’è¡¨ç¤ºã™ã‚‹**ï¼ˆatbb_statusã«é–¢ä¿‚ãªãï¼‰
2. âœ… **ãƒãƒƒã‚¸ã§çŠ¶æ…‹ã‚’è¡¨ç¤ºã™ã‚‹**ï¼ˆå…¬é–‹å‰ã€é…ä¿¡é™å®šã€æˆç´„æ¸ˆã¿ï¼‰
3. âœ… **ã‚½ãƒ¼ãƒˆé †ã¯`distribution_date DESC, created_at DESC`**

**çµ¶å¯¾ã«`atbb_status`ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãªã„ã€‚å…¨ã¦ã®ç‰©ä»¶ã‚’è¡¨ç¤ºã™ã‚‹ã€‚**

---

**æœ€çµ‚æ›´æ–°æ—¥**: 2026å¹´2æœˆ3æ—¥  
**ä½œæˆç†ç”±**: å…¬é–‹ç‰©ä»¶ã‚µã‚¤ãƒˆã¯å…¨ã¦ã®ç‰©ä»¶ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã‚’æ˜ç¢ºåŒ–ã™ã‚‹ãŸã‚  
**æ›´æ–°å±¥æ­´**: 
- 2026å¹´2æœˆ3æ—¥: ã€Œå…¬é–‹ä¸­ã®ç‰©ä»¶ã ã‘ã‚’è¡¨ç¤ºã™ã‚‹ã€ã¨ã„ã†é–“é•ã£ãŸå®šç¾©ã‚’å‰Šé™¤ã—ã€ã€Œå…¨ã¦ã®ç‰©ä»¶ã‚’è¡¨ç¤ºã™ã‚‹ã€ã¨ã„ã†æ­£ã—ã„å®šç¾©ã«å¤‰æ›´

