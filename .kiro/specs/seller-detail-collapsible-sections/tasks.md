# 通話モードページの折りたたみ可能セクション追加 - タスクリスト

## タスク概要

通話モードページ（CallModePage.tsx）の「近隣買主リスト」と「実績」のセクションを、ボタンをクリックすることで表示/非表示を切り替えられるようにします。

---

## タスク

### 1. 準備作業

- [x] 1.1 既存のCollapsibleSectionコンポーネントの動作確認
  - CollapsibleSectionが遅延読み込みをサポートしているか確認
  - defaultExpandedプロパティの動作確認

- [x] 1.2 通話モードページの現在の実装確認
  - 「近隣買主リスト」セクション（行2901-2909付近）の確認
  - 「実績セクション」（行4988-4991付近）の確認
  - CollapsibleSectionのインポートがあるか確認

### 2. 実装

- [x] 2.1 CollapsibleSectionのインポート確認・追加
  - CallModePage.tsxにCollapsibleSectionのインポートがあるか確認
  - 存在しない場合は追加: `import CollapsibleSection from '../components/CollapsibleSection';`

- [x] 2.2 「近隣買主リスト」セクションの修正
  - 行2901-2909付近のコードを修正
  - `<Box>`を`<CollapsibleSection>`に置き換え
  - `title="近隣買主リスト"`を設定
  - `defaultExpanded={false}`を設定
  - `<Typography variant="h6">`のタイトル行を削除（CollapsibleSectionが自動で表示）

- [x] 2.3 「実績」セクションの修正
  - 行4988-4991付近のコードを修正
  - `<Box>`を`<CollapsibleSection>`に置き換え
  - `title="実績"`を設定
  - `defaultExpanded={false}`を設定

### 3. テスト

- [x] 3.1 ローカル環境でのテスト
  - 通話モードページを開く
  - 「近隣買主リスト」ボタンが表示されることを確認
  - 「実績」ボタンが表示されることを確認
  - 初期状態で両方のセクションが折りたたまれていることを確認

- [ ] 3.2 「近隣買主リスト」の動作確認
  - ボタンをクリックしてセクションが展開されることを確認
  - 近隣買主リストが正しく表示されることを確認
  - 再度ボタンをクリックしてセクションが折りたたまれることを確認

- [ ] 3.3 「実績」の動作確認
  - ボタンをクリックしてセクションが展開されることを確認
  - 実績データが正しく表示されることを確認
  - 再度ボタンをクリックしてセクションが折りたたまれることを確認

- [ ] 3.4 既存機能への影響確認
  - 既存の通話モードページの機能が正常に動作することを確認
  - ページ読み込み速度が遅くなっていないことを確認
  - 他のセクション（査定計算、コメント入力など）が正常に動作することを確認

### 4. デプロイ

- [ ] 4.1 フロントエンドのビルド
  - `npm run build`を実行
  - ビルドエラーがないことを確認

- [ ] 4.2 Vercelへのデプロイ
  - Gitにコミット・プッシュ
  - Vercelの自動デプロイを確認

- [ ] 4.3 本番環境での動作確認
  - 本番環境で売主詳細画面を開く
  - 「近隣買主リスト」と「実績」のセクションが正しく動作することを確認

### 5. ドキュメント更新

- [ ] 5.1 READMEの更新（必要な場合）
  - 新しいセクションの説明を追加

- [ ] 5.2 変更履歴の記録
  - CHANGELOGに変更内容を記録

---

## 完了条件

- [ ] 通話モードページの「近隣買主リスト」と「実績」がボタンで折りたたみ可能になる
- [ ] ボタンをクリックすると、対応するセクションが展開/折りたたまれる
- [ ] 近隣買主リストと実績の内容が現在と同じように表示される
- [ ] 既存の通話モードページの機能に影響がない
- [ ] ページの読み込み速度が遅くならない
- [ ] 本番環境で正常に動作する

---

## 推定工数

- 準備作業: 0.5時間
- 実装: 0.5時間（既存コードの修正のみ）
- テスト: 1時間
- デプロイ: 0.5時間
- ドキュメント更新: 0.5時間

**合計**: 約3時間

---

## 依存関係

- 既存のCollapsibleSectionコンポーネント
- 既存のNearbyBuyersListコンポーネント（通話モードページで既に使用中）
- 既存のPerformanceMetricsSectionコンポーネント（通話モードページで既に使用中）
- 既存のAPIエンドポイント（/api/sellers/${sellerId}/nearby-buyers、/api/performance-metrics）

---

## リスク

1. **パフォーマンスリスク**: 近隣買主リストと実績データの読み込みが遅い場合、ページ全体の読み込みが遅くなる可能性
   - 対策: CollapsibleSectionの遅延読み込み機能を確認・実装

2. **互換性リスク**: 既存のコンポーネントが売主詳細画面で正しく動作しない可能性
   - 対策: 通話モードページと同じpropsを渡す

---

## 次のステップ

1. タスク1.1から順番に実行
2. 各タスク完了後、チェックボックスにチェックを入れる
3. 問題が発生した場合は、設計ドキュメントを見直す
4. 全タスク完了後、本番環境にデプロイ
