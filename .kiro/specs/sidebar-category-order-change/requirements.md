# サイドバーカテゴリー表示順序変更

## 概要

売主リストページのサイドバーにおいて、「担当(イニシャル)」カテゴリーの表示順序を変更する。
現在は最初に表示されているが、これを最後に移動する。

---

## 背景

現在のサイドバーカテゴリーの表示順序：

1. **All**
2. **担当(イニシャル)** ← 現在ここ（最初）
   - └ 当日TEL(イニシャル)
   - └ その他(イニシャル)
3. ③当日TEL分
4. 当日TEL(内容別)
5. ⑤未査定
6. ⑥査定（郵送）
7. ⑦当日TEL_未着手
8. ⑧Pinrich空欄

**問題**: 「担当(イニシャル)」が最初に来ているため、他のカテゴリーが下に押し下げられている。

---

## 要件

### 1. 表示順序の変更

**変更後の表示順序**:

1. **All**
2. **③当日TEL分**
3. **当日TEL(内容別)** - コミュニケーション情報別カテゴリ
4. **⑤未査定**
5. **⑥査定（郵送）**
6. **⑦当日TEL_未着手**
7. **⑧Pinrich空欄**
8. **担当(イニシャル)** ← **最後に移動**
   - └ 当日TEL(イニシャル)
   - └ その他(イニシャル)

### 2. 機能の維持

以下の機能は変更しない：

- ✅ 各カテゴリーのクリック動作
- ✅ 件数の表示
- ✅ サブカテゴリーの表示（当日TEL、その他）
- ✅ 選択状態のハイライト
- ✅ 通話モードページでの動作

### 3. 影響範囲

**変更対象ファイル**:
- `frontend/src/components/SellerStatusSidebar.tsx` - サイドバーコンポーネント

**変更しないファイル**:
- バックエンドAPI（`backend/src/services/SellerService.supabase.ts`）
- フィルタリングロジック（`frontend/src/utils/sellerStatusFilters.ts`）
- 売主リストページ（`frontend/src/pages/SellersPage.tsx`）

---

## 受け入れ基準

### 1.1 表示順序が正しい

**条件**: サイドバーを開いたとき

**期待される動作**:
- 「All」の次に「③当日TEL分」が表示される
- 「担当(イニシャル)」が最後に表示される
- 他のカテゴリーの順序は変更されない

**検証方法**:
1. 売主リストページを開く
2. サイドバーのカテゴリー順序を確認
3. 「担当(イニシャル)」が最後に表示されることを確認

---

### 1.2 サブカテゴリーが正しく表示される

**条件**: 「担当(イニシャル)」カテゴリーを確認

**期待される動作**:
- 「担当(イニシャル)」の下に「└ 当日TEL(イニシャル)」が表示される
- 「担当(イニシャル)」の下に「└ その他(イニシャル)」が表示される
- インデントが正しく表示される

**検証方法**:
1. 売主リストページを開く
2. 「担当(イニシャル)」カテゴリーを確認
3. サブカテゴリーが正しく表示されることを確認

---

### 1.3 クリック動作が正常

**条件**: 各カテゴリーをクリック

**期待される動作**:
- 「担当(イニシャル)」をクリックすると、該当する売主がフィルタリングされる
- サブカテゴリーをクリックすると、該当する売主がフィルタリングされる
- 選択状態がハイライトされる

**検証方法**:
1. 「担当(イニシャル)」をクリック
2. メインテーブルに該当する売主が表示されることを確認
3. サブカテゴリーをクリック
4. メインテーブルに該当する売主が表示されることを確認

---

### 1.4 通話モードページでの動作が正常

**条件**: 通話モードページを開く

**期待される動作**:
- サイドバーのカテゴリー順序が変更されている
- 現在の売主のカテゴリーがハイライトされる
- カテゴリーをクリックすると、該当する売主の通話モードページに遷移する

**検証方法**:
1. 通話モードページを開く
2. サイドバーのカテゴリー順序を確認
3. 「担当(イニシャル)」が最後に表示されることを確認
4. カテゴリーをクリックして動作を確認

---

## 技術的な詳細

### 変更箇所

**ファイル**: `frontend/src/components/SellerStatusSidebar.tsx`

**関数**: `renderAllCategories()`

**変更内容**:
```typescript
// 現在の順序
<Box sx={{ display: 'flex', flexDirection: 'column', gap: 0.5 }}>
  {/* All */}
  <Button>All</Button>
  
  {/* 担当(イニシャル) - 現在ここ */}
  {categoryCounts?.assigneeGroups && ...}
  
  {/* ③当日TEL分 */}
  {renderCategoryButton('todayCall', ...)}
  
  {/* 当日TEL(内容別) */}
  {todayCallWithInfoGroups.map(...)}
  
  {/* ⑤未査定 */}
  {renderCategoryButton('unvaluated', ...)}
  
  {/* ⑥査定（郵送） */}
  {renderCategoryButton('mailingPending', ...)}
  
  {/* ⑦当日TEL_未着手 */}
  {renderCategoryButton('todayCallNotStarted', ...)}
  
  {/* ⑧Pinrich空欄 */}
  {renderCategoryButton('pinrichEmpty', ...)}
</Box>
```

**変更後の順序**:
```typescript
<Box sx={{ display: 'flex', flexDirection: 'column', gap: 0.5 }}>
  {/* All */}
  <Button>All</Button>
  
  {/* ③当日TEL分 */}
  {renderCategoryButton('todayCall', ...)}
  
  {/* 当日TEL(内容別) */}
  {todayCallWithInfoGroups.map(...)}
  
  {/* ⑤未査定 */}
  {renderCategoryButton('unvaluated', ...)}
  
  {/* ⑥査定（郵送） */}
  {renderCategoryButton('mailingPending', ...)}
  
  {/* ⑦当日TEL_未着手 */}
  {renderCategoryButton('todayCallNotStarted', ...)}
  
  {/* ⑧Pinrich空欄 */}
  {renderCategoryButton('pinrichEmpty', ...)}
  
  {/* 担当(イニシャル) - 最後に移動 */}
  {categoryCounts?.assigneeGroups && ...}
</Box>
```

---

## 非機能要件

### パフォーマンス
- レンダリング速度に影響を与えない
- 既存のパフォーマンスを維持

### 互換性
- 既存の機能との互換性を維持
- バックエンドAPIとの互換性を維持

---

## テストケース

### テストケース1: 表示順序の確認

**手順**:
1. 売主リストページを開く
2. サイドバーのカテゴリー順序を確認

**期待結果**:
- 「All」の次に「③当日TEL分」が表示される
- 「担当(イニシャル)」が最後に表示される

---

### テストケース2: サブカテゴリーの確認

**手順**:
1. 売主リストページを開く
2. 「担当(イニシャル)」カテゴリーを確認

**期待結果**:
- 「└ 当日TEL(イニシャル)」が表示される
- 「└ その他(イニシャル)」が表示される

---

### テストケース3: クリック動作の確認

**手順**:
1. 「担当(Y)」をクリック
2. メインテーブルを確認

**期待結果**:
- 営担がYの売主のみが表示される
- 「担当(Y)」がハイライトされる

---

### テストケース4: 通話モードページでの確認

**手順**:
1. 営担がYの売主の通話モードページを開く
2. サイドバーを確認

**期待結果**:
- 「担当(Y)」が最後に表示される
- 「担当(Y)」がハイライトされる

---

## 制約事項

### 変更しない項目
- バックエンドAPI
- フィルタリングロジック
- カテゴリーの定義
- カテゴリーの条件

### 影響を受けない機能
- カテゴリーのクリック動作
- 件数の表示
- サブカテゴリーの表示
- 選択状態のハイライト

---

## 参考資料

### 関連ドキュメント
- `.kiro/steering/sidebar-status-definition.md` - サイドバーステータス定義
- `.kiro/steering/sidebar-api-response-validation.md` - APIレスポンス検証ルール

### 関連ファイル
- `frontend/src/components/SellerStatusSidebar.tsx` - サイドバーコンポーネント
- `frontend/src/utils/sellerStatusFilters.ts` - フィルタリングロジック
- `backend/src/services/SellerService.supabase.ts` - サイドバーカウントAPI

---

**作成日**: 2026年2月4日  
**作成者**: システム  
**優先度**: 中
