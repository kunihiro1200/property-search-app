# 買主リスト - 物件情報カード改善

## 📋 概要

買主詳細ページの物件情報カードに以下の改善を実施：
1. 物件番号をコピー可能にする
2. 物件番号の隣にatbb_statusを表示する
3. 買主リストセッション用にステアリングドキュメントを最小限に絞る

---

## 🎯 目的

### ビジネス目的
- 物件番号のコピー操作を効率化し、他システムへの入力作業を削減
- atbb_statusを一目で確認できるようにし、物件の状態把握を迅速化
- 買主リスト作業時のコンテキスト量を削減し、AIの応答速度を向上

### ユーザー目的
- 物件番号を手入力せずにコピー&ペーストで使用できる
- 物件のatbb_status（成約済み/非公開等）を物件番号と同時に確認できる
- 買主リスト作業時に不要な物件関連ドキュメントが読み込まれない

---

## 👥 ユーザーストーリー

### US-1: 物件番号のコピー
**As a** 営業担当者  
**I want to** 物件番号をワンクリックでコピーできる  
**So that** 他のシステムやスプレッドシートに素早く入力できる

**受け入れ基準**:
- [ ] 物件番号の横にコピーボタンが表示される
- [ ] コピーボタンをクリックすると物件番号がクリップボードにコピーされる
- [ ] コピー成功時に視覚的なフィードバック（スナックバー等）が表示される
- [ ] コピー失敗時にエラーメッセージが表示される

---

### US-2: atbb_statusの表示
**As a** 営業担当者  
**I want to** 物件番号の隣にatbb_statusを表示する  
**So that** 物件の状態（成約済み/非公開等）を一目で確認できる

**受け入れ基準**:
- [ ] 物件番号の隣にatbb_statusがそのまま表示される（例: 「専任・公開中」）
- [ ] atbb_statusが空の場合は「-」または非表示
- [ ] 色分けは不要（テキストのみ表示）
- [ ] 既存のステータス表示と重複しない（既存のstatusフィールドとは別）

---

### US-3: ステアリングドキュメントの最適化
**As a** 開発者  
**I want to** 買主リストセッション時に必要最小限のステアリングドキュメントのみを読み込む  
**So that** AIの応答速度が向上し、コンテキストが明確になる

**受け入れ基準**:
- [ ] 買主リスト関連のステアリングドキュメントのみが自動読み込みされる
- [ ] 物件リスト関連のステアリングドキュメントは手動読み込み（`inclusion: manual`）に設定される
- [ ] README.mdに買主リストセッション用のドキュメント一覧が記載される
- [ ] 不要なドキュメント（売主、物件、エリアマッピング等）が自動読み込みから除外される

---

## 📊 データ要件

### 必要なデータ
- `property_listings.property_number` - 物件番号（コピー対象）
- `property_listings.atbb_status` - atbb_status（表示対象）

### データの取得元
- 既存のAPI: `/api/property-listings/${propertyId}`
- 既存のレスポンスに`atbb_status`が含まれていることを確認

---

## 🎨 UI/UX要件

### 物件番号セクション
**現在**:
```
物件番号
AA13501
```

**改善後**:
```
物件番号                    atbb_status
AA13501 [📋コピー]          専任・公開中
```

### レイアウト
- 物件番号とコピーボタンを横並びに配置
- atbb_statusは物件番号の右側に配置
- コピーボタンはアイコンボタン（ContentCopyIcon）
- atbb_statusはテキストで表示（色分けなし）

---

## 🔧 技術要件

### フロントエンド
- **ファイル**: `frontend/src/components/PropertyInfoCard.tsx`
- **使用コンポーネント**: 
  - `IconButton` + `ContentCopyIcon` - コピーボタン
  - `Typography` - atbb_status表示（テキストのみ）
  - `Snackbar` - コピー成功通知
- **クリップボードAPI**: `navigator.clipboard.writeText()`

### ステアリングドキュメント
- **ファイル**: `.kiro/steering/README.md`
- **変更内容**:
  - 買主リスト関連のみを自動読み込み
  - 物件リスト関連を手動読み込み（`inclusion: manual`）に変更
  - 売主関連、エリアマッピング関連を手動読み込みに変更

---

## 🚫 非機能要件

### パフォーマンス
- コピー操作は100ms以内に完了すること
- atbb_statusの表示は既存のAPI呼び出しを使用し、追加のAPI呼び出しは不要

### アクセシビリティ
- コピーボタンにaria-labelを設定
- キーボード操作でコピーボタンにフォーカス可能

### ブラウザ互換性
- Chrome, Edge, Firefox, SafariでクリップボードAPIが動作すること
- クリップボードAPIが使用できない場合はフォールバック処理を実装

---

## 📝 実装の優先順位

### Phase 1: 物件番号のコピー機能（高優先度）
- コピーボタンの追加
- クリップボードAPIの実装
- コピー成功/失敗の通知

### Phase 2: atbb_statusの表示（高優先度）
- atbb_statusの取得確認
- Typographyコンポーネントでのテキスト表示
- 物件番号の隣に配置

### Phase 3: ステアリングドキュメントの最適化（中優先度）
- README.mdの更新
- 物件リスト関連ドキュメントの`inclusion: manual`設定
- 売主関連、エリアマッピング関連の`inclusion: manual`設定

---

## ✅ 完了条件

- [ ] 物件番号の横にコピーボタンが表示される
- [ ] コピーボタンをクリックすると物件番号がクリップボードにコピーされる
- [ ] コピー成功時にスナックバーが表示される
- [ ] 物件番号の隣にatbb_statusがテキストで表示される（例: 「専任・公開中」）
- [ ] atbb_statusが空の場合は「-」が表示される
- [ ] 買主リストセッション時に必要最小限のステアリングドキュメントのみが読み込まれる
- [ ] 物件リスト関連のステアリングドキュメントが手動読み込みに設定される

---

## 📚 関連ドキュメント

- `.kiro/steering/buyer-table-column-definition.md` - 買主テーブルのカラム定義
- `.kiro/steering/buyer-property-card-sync-rule.md` - 物件詳細カード同期ルール
- `frontend/src/components/PropertyInfoCard.tsx` - 物件情報カードコンポーネント

---

**作成日**: 2026年2月6日  
**作成理由**: 買主リストの物件情報カードの使いやすさを向上させ、ステアリングドキュメントを最適化するため
